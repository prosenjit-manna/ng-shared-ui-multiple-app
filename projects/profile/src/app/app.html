<div class="fixed top-0 left-0 right-0 z-50 ">
	<lib-navbar [user]="currentUser()"
		(openModal)="openModal()"></lib-navbar>
</div>

<main
	class="fixed top-32 bottom-0 left-0 right-0 overflow-y-auto bg-gradient-to-b from-gray-50 to-white">
	<div class="max-w-7xl mx-auto px-4 md:px-8 pb-8">

		<h1 class="text-lg lg:text-xl font-semibold text-gray-900 my-8">
			Welcome {{currentUser()?.name}} !
			<p class=" text-xs text-gray-400 font-medium">Customer Dashboard</p>
		</h1>

		<div class="mb-8">
			<lib-alert-banner
				[dismissible]="true"
				title="Managing your account was never easier. Download the My SPS mobile app
					today.">
				<div class="flex gap-4 flex-wrap justify-start my-4">
					<!-- App Store Button -->
					<a href="#" target="_blank" rel="noopener noreferrer"
						class="inline-flex items-center gap-2 px-6 py-3 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors duration-200">
						<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
							<path
								d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z" />
						</svg>
						<div class="text-left">
							<div class="text-xs">Download on the</div>
							<div class="text-sm font-semibold -mt-1">App Store</div>
						</div>
					</a>

					<!-- Play Store Button -->
					<a href="#" target="_blank" rel="noopener noreferrer"
						class="inline-flex items-center gap-2 px-6 py-3 bg-black text-white rounded-lg hover:bg-gray-800 transition-colors duration-200">
						<svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
							<path
								d="M3,20.5V3.5C3,2.91 3.34,2.39 3.84,2.15L13.69,12L3.84,21.85C3.34,21.6 3,21.09 3,20.5M16.81,15.12L6.05,21.34L14.54,12.85L16.81,15.12M20.16,10.81C20.5,11.08 20.75,11.5 20.75,12C20.75,12.5 20.53,12.9 20.18,13.18L17.89,14.5L15.39,12L17.89,9.5L20.16,10.81M6.05,2.66L16.81,8.88L14.54,11.15L6.05,2.66Z" />
						</svg>
						<div class="text-left">
							<div class="text-xs">Get it on</div>
							<div class="text-sm font-semibold -mt-1">Google Play</div>
						</div>
					</a>

				</div>
			</lib-alert-banner>
		</div>

		<!-- Hierarchical Grid Layout -->
		<div
			class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">

			<div class="lg:row-span-1 h-full">
				<app-card title="Payment Information" [showHeaderBorder]="true"
					customClass="h-full">
					<div class="bg-green-50 border-l-4 border-green-400 p-3 mb-4">
						<p class="text-green-700 text-xs font-medium">The last payment received
							was {{payment.lastPaymentReceived}}</p>
					</div>

					<div class="h-full flex flex-col">
						<div class="grid grid-cols-2 grid-rows-2 gap-4">
							<div class="bg-blue-50 rounded-lg p-4 border border-blue-100">
								<h3 class="text-gray-600 text-xs uppercase tracking-wide mb-1">Payment
									Due Date</h3>
								<p
									class="text-brand text-base lg:text-lg font-bold">{{payment.paymentDueDate}}</p>
							</div>

							<div class="bg-gray-50 rounded-lg p-4 border border-gray-100">
								<h3 class="text-gray-600 text-xs uppercase tracking-wide mb-1">Amount
									Due</h3>
								<p
									class="text-gray-900 text-base lg:text-lg  font-bold">${{payment.paymentAmount
									|
									number:'1.2-2'}}</p>
							</div>
						</div>

						<div class="flex justify-end mt-auto mb-16">
							<lib-button
								variant="secondary"
								size="sm"
								customClass="px-8 py-3">
								Make a Payment
							</lib-button>
						</div>
					</div>
				</app-card>
			</div>

			<!-- Information Hub - Spans 2 columns and 1 row on large screens -->
			<div class="md:col-span-1 lg:col-span-2 lg:row-span-1 h-full">
				<app-card title="Information Hub" [showHeaderBorder]="false"
					customClass="h-full">
					<div class="max-w-md mx-auto h-full flex items-center justify-center">
						<p-chart type="doughnut" [data]="pieData" [options]="pieOptions"
							class="w-full"></p-chart>
					</div>
				</app-card>
			</div>

			<div class="md:col-span-2 lg:col-span-2 lg:row-span-1 h-full">
				<app-card title="Important Messages" [showHeaderBorder]="true"
					subtitle="Please review the following messages"
					customClass="h-full">
					<div class="h-full flex flex-col">
						<ul class="list-disc list-inside space-y-2 text-gray-700">
							@for (message of importantMessages; track $index) {
							<li class="text-sm">{{ message.text }} <a [href]="message.link"
									class="text-blue-600 underline hover:text-blue-700">{{ message.linkText
									}}</a>.</li>
							}
						</ul>

					</div>
				</app-card>
			</div>

			<!-- Account Details - Right below Payment Information -->
			<div class="lg:row-span-1 md:col-span-2 lg:col-span-1 h-full">
				<app-card title="Account Details" [showHeaderBorder]="false"
					customClass="h-full">
					<div class="h-full flex flex-col">

						<div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-8">
							<p class="text-gray-700 text-xs">
								{{accountDetails.payoffQuoteNote}}
								<a [href]="accountDetails.payoffQuoteLink"
									class="text-blue-600 underline hover:text-blue-700">click
									here</a>.
							</p>
						</div>

						<div class="space-y-4">
							<div
								class="flex justify-between items-center py-2 border-b border-gray-100">
								<span class="text-gray-600 text-sm">Customer Name:</span>
								<span
									class="text-gray-900 font-semibold text-sm">{{accountDetails.customerName}}</span>
							</div>

							<div
								class="flex justify-between items-center py-2 border-b border-gray-100">
								<span class="text-gray-600 text-sm">Property Address:</span>
								<span
									class="text-gray-900 font-semibold text-sm">{{accountDetails.propertyAddress}}</span>
							</div>

							<div
								class="flex justify-between items-center py-2 border-b border-gray-100">
								<span class="text-gray-600 text-sm">Principal Balance:</span>
								<span
									class="text-gray-900 font-semibold text-sm">{{accountDetails.principalBalance}}</span>
							</div>

						</div>

						<div class="flex justify-center mt-20">
							<lib-button
								variant="outline"
								size="md"
								customClass="px-8">
								Detailed View
							</lib-button>
						</div>
					</div>
				</app-card>
			</div>

			<!-- Letters & Documents -->
			<div class="lg:row-span-2 md:col-span-2 lg:col-span-3  h-96">
				<app-card title="Letters & Documents" [showHeaderBorder]="false"
					customClass="h-full">
					<p-tabs value="0">
						<p-tablist>
							@for (tab of tabs; track tab.value) {
							<p-tab [value]="tab.value">{{ tab.title }}</p-tab>
							}
						</p-tablist>

						<p-tabpanels>
							@for (tab of tabs; track tab.value) {
							<p-tabpanel [value]="tab.value">
								@if (tab.content === 'letters') {
								<div class="overflow-x-auto">
									<table class="w-full text-sm">
										<thead>
											<tr class="border-b border-gray-200">
												<th class="text-left py-3 px-4 text-gray-600 font-semibold">Letter
													Date</th>
												<th class="text-left py-3 px-4 text-gray-600 font-semibold">Letter
													Name</th>
											</tr>
										</thead>
										<tbody>
											@for (letter of letters; track $index) {
											<tr class="border-b border-gray-100 hover:bg-gray-50">
												<td class="py-3 px-4 text-gray-600">{{ letter.date }}</td>
												<td class="py-3 px-4">
													<a [href]="letter.link"
														class="text-blue-600 hover:text-blue-700 underline">{{ letter.name
														}}</a>
												</td>
											</tr>
											}
										</tbody>
									</table>
								</div>
								}
								@if (tab.content === 'documents') {
								<div class="overflow-x-auto">
									<table class="w-full text-sm">
										<thead>
											<tr class="border-b border-gray-200">
												<th
													class="text-left py-3 px-4 text-gray-600 font-semibold">Document
													Date</th>
												<th
													class="text-left py-3 px-4 text-gray-600 font-semibold">Document
													Name</th>
											</tr>
										</thead>
										<tbody>
											@for (doc of documents; track $index) {
											<tr class="border-b border-gray-100 hover:bg-gray-50">
												<td class="py-3 px-4 text-gray-600">{{ doc.date }}</td>
												<td class="py-3 px-4">
													<a [href]="doc.link"
														class="text-blue-600 hover:text-blue-700 underline">{{ doc.name
														}}</a>
												</td>
											</tr>
											}
										</tbody>
									</table>
								</div>
								}
							</p-tabpanel>
							}
						</p-tabpanels>

					</p-tabs>
				</app-card>
			</div>

		</div>

		<!-- Footer -->
		<lib-footer></lib-footer>
	</div>
</main>
